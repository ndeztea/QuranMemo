!function(t){"use strict";var i=document,e=t;function s(t){var s,n,o,r={pageClass:"dragend-page",direction:"horizontal",minDragDistance:"40",onSwipeStart:f,onSwipeEnd:f,onDragStart:f,onDrag:f,onDragEnd:f,afterInitialize:f,keyboardNavigation:!1,stopPropagation:!1,itemsInPage:1,scribe:0,borderBetweenPages:0,duration:300,preventDrag:!1},a="ontouchstart"in e,h=a?"touchstart":"mousedown",c=a?"touchmove":"mousemove",l=a?"touchend":"mouseup",g={37:"left",38:"up",39:"right",40:"down"},d="No pages found",p={overflow:"hidden",padding:0},u=(s=i.createElement("div"),n="Khtml Ms O Moz Webkit".split(" "),o=n.length,function(t){if(t in s.style)return!0;for(t=t.replace(/^[a-z]/,function(t){return t.toUpperCase()});o--;)if(n[o]+t in s.style)return!0;return!1})("transform");function f(){}function m(t,i){var e,s;for(e in i)if(i.hasOwnProperty(e)){switch(s=i[e],e){case"height":case"width":case"marginLeft":case"marginTop":s+="px"}t.style[e]=s}return t}function v(t,i){var e;for(e in i)t[e]=i[e];return t}function _(t,i){return function(){return t.apply(i,Array.prototype.slice.call(arguments))}}function w(t){var i=t.touches,e=i&&i.length?i:t.changedTouches;return{x:a?e[0].pageX:t.pageX,y:a?e[0].pageY:t.pageY}}function y(t,e){var s=v({},r);this.settings=v(s,e),this.container=t,this.pageContainer=i.createElement("div"),this.scrollBorder={x:0,y:0},this.page=0,this.preventScroll=!1,this.pageCssProperties={margin:0},this._onStart=_(this._onStart,this),this._onMove=_(this._onMove,this),this._onEnd=_(this._onEnd,this),this._onKeydown=_(this._onKeydown,this),this._sizePages=_(this._sizePages,this),this._afterScrollTransform=_(this._afterScrollTransform,this),this.pageContainer.innerHTML=t.cloneNode(!0).innerHTML,t.innerHTML="",t.appendChild(this.pageContainer),this._scroll=u?this._scrollWithTransform:this._scrollWithoutTransform,this._animateScroll=u?this._animateScrollWithTransform:this._animateScrollWithoutTransform,m(t,p),setTimeout(_(function(){this.updateInstance(e),this.settings.preventDrag||this._observe(),this.settings.afterInitialize.call(this)},this),10)}function b(i,e,s){t?t(i).on(e,s):i.addEventListener(e,s,!1)}function P(i,e,s){t?t(i).off(e,s):i.removeEventListener(e,s,!1)}return v(y.prototype,{_checkOverscroll:function(t,i,e){var s={x:i,y:e,overscroll:!0};switch(t){case"right":if(!this.scrollBorder.x)return s.x=Math.round((i-this.scrollBorder.x)/5),s;break;case"left":if((this.pagesCount-1)*this.pageDimentions.width<=this.scrollBorder.x)return s.x=Math.round(-(Math.ceil(this.pagesCount)-1)*(this.pageDimentions.width+this.settings.borderBetweenPages)+i/5),s;break;case"down":if(!this.scrollBorder.y)return s.y=Math.round((e-this.scrollBorder.y)/5),s;break;case"up":if((this.pagesCount-1)*this.pageDimentions.height<=this.scrollBorder.y)return s.y=Math.round(-(Math.ceil(this.pagesCount)-1)*(this.pageDimentions.height+this.settings.borderBetweenPages)+e/5),s}return{x:i-this.scrollBorder.x,y:e-this.scrollBorder.y,overscroll:!1}},_observe:function(){b(this.container,h,this._onStart),this.settings.keyboardNavigation&&b(i.body,"keydown",this._onKeydown),b(e,"resize",this._sizePages)},_onStart:function(t){t=t.originalEvent||t,this.settings.stopPropagation&&t.stopPropagation(),b(i.body,c,this._onMove),b(i.body,l,this._onEnd),this.startCoords=w(t),this.settings.onDragStart.call(this,t)},_onMove:function(t){if(!((t=t.originalEvent||t).touches&&t.touches.length>1||t.scale&&1!==t.scale)){t.preventDefault(),this.settings.stopPropagation&&t.stopPropagation();var i=this._parseEvent(t),e=this._checkOverscroll(i.direction,-i.distanceX,-i.distanceY);this.settings.onDrag.call(this,this.activeElement,i,e.overscroll,t),this.preventScroll||this._scroll(e)}},_onEnd:function(t){t=t.originalEvent||t,this.settings.stopPropagation&&t.stopPropagation();var e=this._parseEvent(t);this.startCoords={x:0,y:0},Math.abs(e.distanceX)>this.settings.minDragDistance||Math.abs(e.distanceY)>this.settings.minDragDistance?this.swipe(e.direction):(e.distanceX>0||e.distanceX>0)&&this._scrollToPage(),this.settings.onDragEnd.call(this,this.container,this.activeElement,this.page,t),P(i.body,c,this._onMove),P(i.body,l,this._onEnd)},_parseEvent:function(t){var i=w(t),e=this.startCoords.x-i.x,s=this.startCoords.y-i.y;return this._addDistanceValues(e,s)},_addDistanceValues:function(t,i){var e={distanceX:0,distanceY:0};return"horizontal"===this.settings.direction?(e.distanceX=t,e.direction=t>0?"left":"right"):(e.distanceY=i,e.direction=i>0?"up":"down"),e},_onKeydown:function(t){var i=g[t.keyCode];i&&this._scrollToPage(i)},_setHorizontalContainerCssValues:function(){v(this.pageCssProperties,{cssFloat:"left",overflowY:"auto",overflowX:"hidden",padding:0,display:"block"}),m(this.pageContainer,{overflow:"hidden",width:(this.pageDimentions.width+this.settings.borderBetweenPages)*this.pagesCount,boxSizing:"content-box","-webkit-backface-visibility":"hidden","-webkit-perspective":1e3,margin:0,padding:0})},_setVerticalContainerCssValues:function(){v(this.pageCssProperties,{overflow:"hidden",padding:0,display:"block"}),m(this.pageContainer,{"padding-bottom":this.settings.scribe,boxSizing:"content-box","-webkit-backface-visibility":"hidden","-webkit-perspective":1e3,margin:0})},setContainerCssValues:function(){"horizontal"===this.settings.direction?this._setHorizontalContainerCssValues():this._setVerticalContainerCssValues()},_setPageDimentions:function(){var t=this.container.offsetWidth,i=this.container.offsetHeight;"horizontal"===this.settings.direction?t-=parseInt(this.settings.scribe,10):i-=parseInt(this.settings.scribe,10),this.pageDimentions={width:t,height:i}},_sizePages:function(){var t=this.pages.length;this._setPageDimentions(),this.setContainerCssValues(),"horizontal"===this.settings.direction?v(this.pageCssProperties,{height:this.pageDimentions.height,width:this.pageDimentions.width/this.settings.itemsInPage}):v(this.pageCssProperties,{height:this.pageDimentions.height/this.settings.itemsInPage,width:this.pageDimentions.width});for(var i=0;i<t;i++)m(this.pages[i],this.pageCssProperties);this._jumpToPage("page",this.page)},_calcNewPage:function(t,i){var e=this.settings.borderBetweenPages,s=this.pageDimentions.height,n=this.pageDimentions.width,o=this.page;switch(t){case"up":o<this.pagesCount-1&&(this.scrollBorder.y=this.scrollBorder.y+s+e,this.page++);break;case"down":o>0&&(this.scrollBorder.y=this.scrollBorder.y-s-e,this.page--);break;case"left":o<this.pagesCount-1&&(this.scrollBorder.x=this.scrollBorder.x+n+e,this.page++);break;case"right":o>0&&(this.scrollBorder.x=this.scrollBorder.x-n-e,this.page--);break;case"page":switch(this.settings.direction){case"horizontal":this.scrollBorder.x=(n+e)*i;break;case"vertical":this.scrollBorder.y=(s+e)*i}this.page=i;break;default:this.scrollBorder.y=0,this.scrollBorder.x=0,this.page=0}},_onSwipeEnd:function(){this.preventScroll=!1,this.activeElement=this.pages[this.page*this.settings.itemsInPage],this.settings.onSwipeEnd.call(this,this.container,this.activeElement,this.page)},_jumpToPage:function(t,i){t&&this._calcNewPage(t,i),this._scroll({x:-this.scrollBorder.x,y:-this.scrollBorder.y})},_scrollToPage:function(t,i){this.preventScroll=!0,t&&this._calcNewPage(t,i),this._animateScroll()},_scrollWithTransform:function(t){var i="horizontal"===this.settings.direction?"translateX("+t.x+"px)":"translateY("+t.y+"px)";m(this.pageContainer,{"-webkit-transform":i,"-moz-transform":i,"-ms-transform":i,"-o-transform":i,transform:i})},_animateScrollWithTransform:function(){var t="transform "+this.settings.duration+"ms ease-out",i=(this.container,this._afterScrollTransform);m(this.pageContainer,{"-webkit-transition":"-webkit-"+t,"-moz-transition":"-moz-"+t,"-ms-transition":"-ms-"+t,"-o-transition":"-o-"+t,transition:t}),this._scroll({x:-this.scrollBorder.x,y:-this.scrollBorder.y}),b(this.container,"webkitTransitionEnd",i),b(this.container,"oTransitionEnd",i),b(this.container,"transitionend",i),b(this.container,"transitionEnd",i)},_afterScrollTransform:function(){var t=this.container,i=this._afterScrollTransform;this._onSwipeEnd(),P(t,"webkitTransitionEnd",i),P(t,"oTransitionEnd",i),P(t,"transitionend",i),P(t,"transitionEnd",i),m(this.pageContainer,{"-webkit-transition":"","-moz-transition":"","-ms-transition":"","-o-transition":"",transition:""})},_scrollWithoutTransform:function(t){var i="horizontal"===this.settings.direction?{marginLeft:t.x}:{marginTop:t.y};m(this.pageContainer,i)},_animateScrollWithoutTransform:function(){var i,e,s,n,o,r,a="horizontal"===this.settings.direction?"marginLeft":"marginTop",h="horizontal"===this.settings.direction?-this.scrollBorder.x:-this.scrollBorder.y;i=this.pageContainer,e=a,s=h,n=this.settings.duration,o=_(this._onSwipeEnd,this),(r={})[e]=s,t?t(i).animate(r,n,o):m(i,r)},swipe:function(t){this.settings.onSwipeStart.call(this,this.container,this.activeElement,this.page),this._scrollToPage(t)},updateInstance:function(i){var e,s;if("object"==typeof(i=i||{})&&v(this.settings,i),this.pages=(e=this.settings.pageClass,s=this.pageContainer,t?t(s).find("."+e):Array.prototype.slice.call(s.getElementsByClassName(e))),!this.pages.length)throw new Error(d);this.pagesCount=this.pages.length/this.settings.itemsInPage,this.activeElement=this.pages[this.page*this.settings.itemsInPage],this._sizePages(),this.settings.jumpToPage&&(this.jumpToPage(i.jumpToPage),delete this.settings.jumpToPage),this.settings.scrollToPage&&(this.scrollToPage(this.settings.scrollToPage),delete this.settings.scrollToPage)},destroy:function(){var t=this.container;P(t,h),P(t,c),P(t,l),P(i.body,"keydown",this._onKeydown),P(e,"resize",this._sizePages),t.removeAttribute("style");for(var s=0;s<this.pages.length;s++)this.pages[s].removeAttribute("style");t.innerHTML=this.pageContainer.innerHTML},scrollToPage:function(t){this._scrollToPage("page",t-1)},jumpToPage:function(t){this._jumpToPage("page",t-1)}}),t&&(t.fn.dragend=function(i){return i=i||{},this.each(function(){var e=t(this).data("dragend");e?e.updateInstance(i):(e=new y(this,i),t(this).data("dragend",e)),"string"==typeof i&&e.swipe(i)}),this}),y}"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return s(e.jQuery||e.Zepto)}):e.Dragend=s(e.jQuery||e.Zepto)}(window);